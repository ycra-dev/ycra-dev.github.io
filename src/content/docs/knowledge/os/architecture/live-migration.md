---
title: "라이브 마이그레이션 (Live Migration)"
description: "실행 중인 게스트 VM을 서비스 중단 없이 다른 물리 서버로 이동시키는 VMM 기능"
tags: ["OS", "Virtualization", "Datacenter"]
created: 2026-01-27
updated: 2026-01-27
draft: true
slug: knowledge/os/live-migration
sidebar:
  order: 8
---

## 핵심 개념

라이브 마이그레이션(Live Migration)은 실행 중인 게스트 VM을 한 물리 서버에서 다른 서버로 **서비스 중단 없이** 이동시키는 VMM의 기능이다. 일반 OS에서는 서버 이전 시 서비스 중단, 프로세스 종료/재시작이 필요하지만, VMM 환경에서는 게스트 상태가 게스트 내부에 집중되어 있어 이동이 가능하다.

비유하면, 연극 중 배우가 무대를 바꾸는 것과 같다. 관객(사용자)은 전환을 인식하지 못하고 공연이 계속된다.

## 동작 원리

### 마이그레이션 과정

```
Source Server                        Target Server
┌──────────────┐                    ┌──────────────┐
│   Guest VM   │                    │              │
│  (running)   │                    │              │
└──────┬───────┘                    └──────────────┘
       │
       │ 1. 연결 수립 + 권한 확인
       ├────────────────────────────────────────►
       │
       │ 2. R/O 페이지 전송
       ├────────────────────────────────────────►
       │
       │ 3. R/W 페이지 전송 (게스트 계속 실행)
       ├────────────────────────────────────────►
       │
       │ 4. Dirty 페이지 반복 전송
       ├────────────────────────────────────────►
       │
       │ 5. 게스트 정지 + 최종 상태 전송
       ├────────────────────────────────────────►
       │
       │                            ┌──────────────┐
       │                            │   Guest VM   │
       │                            │  (resumed)   │
       │                            └──────────────┘
```

1. Source VMM → Target VMM 연결 수립 및 권한 확인
2. Target이 새 게스트를 위한 자원(VCPU, 메모리 등) 할당
3. Source가 **read-only 메모리 페이지** 전송
4. Source가 **read-write 페이지** 전송 (시간 소요)
5. 나머지 **dirty 페이지**(변경된 페이지)를 반복 전송
6. Source가 게스트 정지 → 최종 상태 전송 → Target에서 재개

### 성공 조건

| 조건 | 설명 |
|------|------|
| **네트워크** | 스위치가 MAC 주소 이동 인식, 기존 연결 유지 |
| **스토리지** | 네트워크 스토리지(NAS/SAN) 사용 필수. 디스크 상태는 전송 불가 (너무 큼) |
| **동일 VMM** | Source/Target이 같은 VMM 환경이어야 함 |

### 왜 일반 OS에서는 불가능한가

| 특성 | VMM | 일반 OS |
|------|-----|---------|
| 상태 위치 | 게스트 내부에 집중 | 커널에 분산 |
| 인터페이스 | 명확한 가상화 경계 | 복잡한 시스템콜/커널 상태 |
| 네트워크 | VMM이 관리 | OS가 직접 관리 |
| 디스크 | 원격 스토리지 권장 | 로컬 디스크 일반적 |

### 활용

- **부하 분산**: 과부하 서버에서 여유 서버로 게스트 이동
- **하드웨어 유지보수**: 서버 점검 전 게스트 대피
- **에너지 효율**: 비활성 시간에 게스트 통합하여 서버 수 줄임
- **자동화 관리**: 가상화 관리 도구가 자동으로 자원 밸런싱

## 예시

서버 A가 과부하 상태일 때:
1. 가상화 관리 도구가 여유 서버 B를 식별
2. 게스트 VM의 메모리를 B로 전송 (게스트는 계속 실행)
3. 최종 dirty 페이지 전송 후 B에서 게스트 재개
4. 사용자는 중단을 인식하지 못함

## 관련 개념

- [가상화 (Virtualization)](/knowledge/os/virtualization/) - 가상화의 상위 개념
- [하드웨어 가상화 지원 (VT-x/AMD-V)](/knowledge/os/hw-virtualization/) - VMM의 기반 기술
- [분산 시스템 (Distributed System)](/knowledge/os/distributed-system/) - 데이터센터 분산 환경
- [컨테이너 (Container)](/knowledge/os/container/) - 컨테이너도 유사한 마이그레이션 지원
