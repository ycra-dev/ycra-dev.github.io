---
title: "HAL (Hardware Abstraction Layer)"
description: "하드웨어 칩셋의 차이를 상위 계층으로부터 숨겨 동일한 커널/드라이버 바이너리가 다양한 하드웨어에서 동작하게 하는 DLL"
tags: ["OS", "Windows", "Architecture"]
created: 2026-01-27
updated: 2026-01-27
draft: true
slug: knowledge/os/hal
sidebar:
  order: 15
---

## 핵심 개념

HAL(Hardware Abstraction Layer)은 하드웨어 칩셋의 차이를 상위 계층(커널, 드라이버)으로부터 숨겨, 동일한 커널/드라이버 바이너리가 다양한 하드웨어에서 동작할 수 있게 하는 DLL입니다. Windows NT 설계 시 이식성(portability)을 핵심 목표로 삼아, CPU 아키텍처 이식은 커널의 아키텍처 의존 코드로, 칩셋 차이는 HAL로 분리했습니다.

## 동작 원리

HAL은 커널과 함께 부팅 시 로드되는 DLL(`ntoskrnl.exe`가 `hal.dll`에 의존)입니다.

```
┌──────────────────────────────────────┐
│   Kernel / Executive / Drivers       │
│   (하드웨어 독립적 코드)               │
└──────────────────┬───────────────────┘
                   │ HAL 인터페이스 호출
                   ▼
┌──────────────────────────────────────┐
│            HAL (hal.dll)             │
│  - 인터럽트 컨트롤러 추상화            │
│  - 타이머 관리                        │
│  - DMA 설정                          │
│  - I/O 버스 구성                      │
└──────────────────┬───────────────────┘
                   │
                   ▼
┌──────────────────────────────────────┐
│    HAL Extensions (Windows 8+)       │
│  SoC별 동적 로드 (ARM 칩셋 대응)       │
└──────────────────┬───────────────────┘
                   │
                   ▼
┌──────────────────────────────────────┐
│            Hardware                  │
│  (인터럽트 컨트롤러, 타이머, DMA 등)   │
└──────────────────────────────────────┘
```

### HAL 인터페이스

- 메모리 매핑 (I/O 공간 ↔ 가상 주소)
- I/O 버스 구성
- DMA 설정
- 인터럽트 컨트롤러 접근
- 타이머 관리
- 전원 관리 인터페이스

동일 CPU 아키텍처 내에서는 **HAL만 교체하면** 다른 칩셋에서 동작 가능합니다.

## 예시

전기 콘센트 어댑터에 비유할 수 있습니다. 한국 가전제품(커널)이 미국 콘센트(다른 칩셋)에서 동작하려면 어댑터(HAL)만 바꾸면 됩니다.

과거 Windows는 450개 이상의 HAL이 존재했으나, ACPI 표준화로 PC 하드웨어가 통일되면서 현재 AMD64 Windows 10은 **단일 HAL**만 사용합니다. 반면 ARM 모바일 시장은 칩셋이 다양해서 HAL Extensions로 동적 대응합니다.

### 장단점

- **장점**: 커널과 드라이버를 칩셋별로 재작성 불필요, 칩셋 변경 시 HAL만 수정, CPU 아키텍처당 하나의 드라이버만 배포
- **단점**: 간접 호출 오버헤드, HAL Extensions 필요 시 복잡성 증가, 극한의 하드웨어 최적화 제약

## 관련 개념

- [디바이스 드라이버](/knowledge/os/device-driver/)
- [객체 관리자 (Object Manager)](/knowledge/os/object-manager/)
- [APC와 DPC](/knowledge/os/apc-dpc/)
